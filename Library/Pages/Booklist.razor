@page "/Booklist"
@using Library.Data
@inject AuthService AuthService
@inject BookRepository BookRepository

<PageTitle>Book List</PageTitle>

@if (!AuthService.IsAuthenticated)
{
    <p>Please <a href="/login">log in</a> to see the book list.</p>
}
else
{
    <h1>Welcome, @AuthService.LoggedInUser.Name!</h1>

    <h2>Available Books</h2>
    @if (books == null)
    {
        <p>Loading books...</p>
    }
    else if (books.Count == 0)
    {
        <p>No books found.</p>
    }
    else
    {
        <ul>
            @foreach (var book in books)
            {
                <li>
                    <strong>@book.Title</strong> by @book.Author<br />
                    Genre: @book.Genre<br />
                    @book.Summary
                </li>
            }
        </ul>
    }
}

@code {
    private List<Book> books;

    protected override void OnInitialized()
    {
        if (AuthService.IsAuthenticated)
        {
            books = BookRepository.GetAllBooks();
        }
    }
}
