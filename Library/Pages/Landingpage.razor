@page "/"
@inject NavigationManager NavigationManager

<PageTitle>Index</PageTitle>

<div class="background-container">
    <div class="overlay">
        <h1>Welcome to your ONLINE BOOKSHELF</h1>

        <div class="search-wrapper">
            <div class="search-bar">        
                <input type="search" placeholder="Search for a book" @bind="searchTerm" />
                <button @onclick="SearchBooks">Search</button>
            </div>
        </div>

        <p>Welcome to your new app.</p>

        <div class="book-carousel">
            <div class="arrow left-arrow" @onclick="MoveLeft">&#10094;</div>

            <div class="book-preview-bar">
                @for (int i = currentIndex; i < currentIndex + itemsPerPage && i < totalItems; i++)
                {
                    <div class="book-preview-item" @onclick="() => NavigateToGenrePage(genres[i])">
                        <div class="book-image-placeholder"></div>
                        <div class="genre-label">@genres[i]</div> 
                    </div>
                }
            </div>

            <div class="arrow right-arrow" @onclick="MoveRight">&#10095;</div>
        </div>

        <SurveyPrompt Title="How is Blazor working for you?" />
    </div>
</div>

@code {
    private int currentIndex = 0;
    private const int itemsPerPage = 3;
    private const int totalItems = 10;

    private List<string> genres = new()
    {
        "Romane", "Krimis", "Thriller", "Fantasy", "Science Fiction",
        "Horror", "Reise", "Jugendbuch", "Kinderbuch", "Sachbuch"
    };

    private string searchTerm = string.Empty;

    private void MoveLeft()
    {
        if (currentIndex > 0) currentIndex--;
    }

    private void MoveRight()
    {
        if (currentIndex < totalItems - itemsPerPage) currentIndex++;
    }

    private void NavigateToGenrePage(string genre)
    {
        NavigationManager.NavigateTo($"/genrespage");
    }

    private void SearchBooks()
    {
        if (!string.IsNullOrWhiteSpace(searchTerm))
        {
            NavigationManager.NavigateTo($"/searchresults/{searchTerm}");
        }
    }
}
