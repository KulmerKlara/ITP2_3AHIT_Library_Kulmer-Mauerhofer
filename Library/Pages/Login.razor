@page "/login"
@using Library.Data
@inject UserRepository UserRepository

@code {
    private bool showSignUp = false;

    private string signUpName = "";
    private string signUpEmail = "";
    private string signUpPassword = "";
    private string signUpPhone = "";
    private string signUpRole = "Customer";

    private string? message;

    private void ToggleSignUp()
    {
        showSignUp = !showSignUp;
        message = null; // Zur√ºcksetzen
    }

    private async Task HandleSignUp()
    {
        var existing = UserRepository.GetUserByEmail(signUpEmail);
        if (existing != null)
        {
            message = "E-Mail ist bereits registriert.";
            return;
        }

        var newUser = new User(0, signUpName, signUpEmail, signUpPassword, signUpPhone, signUpRole);
        UserRepository.AddUser(newUser);
        message = "Registrierung erfolgreich!";

        showSignUp = false;

        signUpName = signUpEmail = signUpPassword = signUpPhone = "";
    }
}

<div class="container" style="display: flex; justify-content: space-between; align-items: flex-start;">
    <div class="form-block login" style="width: 45%; display: @(showSignUp ? "none" : "block");">
        <h1>Sign in</h1>
        <div class="social-container">
            <a href="#" class="social"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="social"><i class="fab fa-google-plus-g"></i></a>
            <a href="#" class="social"><i class="fab fa-linkedin-in"></i></a>
        </div>

        <div>
            <input type="email" placeholder="Email" />
        </div>

        <br />

        <div>
            <input type="password" placeholder="Password" required />
        </div>

        <br />

        <button>Sign In</button>

        <br /><br />
        <button @onclick="ToggleSignUp">Sign Up</button>
    </div>

    @if (showSignUp)
    {
        <div class="form-block signup" style="width: 45%;">
            <h1>Create Account</h1>

            <div>
                <input type="text" placeholder="Name" @bind="signUpName" />
            </div>

            <br />

            <div>
                <input type="email" placeholder="Email" @bind="signUpEmail" />
            </div>

            <br />

            <div>
                <input type="password" placeholder="Password" @bind="signUpPassword" />
            </div>

            <br />

            <div>
                <input type="text" placeholder="Phone" @bind="signUpPhone" />
            </div>

            <br />

            <div>
                <select @bind="signUpRole">
                    <option value="Customer">Customer</option>
                    <option value="Employee">Employee</option>
                </select>
            </div>

            <br />

            <div>
                <button @onclick="HandleSignUp">Sign Up</button>
            </div>

            <br />

            <button @onclick="ToggleSignUp">Back to Sign In</button>

            @if (!string.IsNullOrEmpty(message))
            {
                <p>@message</p>
            }
        </div>
    }
</div>
